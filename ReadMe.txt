===========================================================================
【 ソフト名 】　Aipo支援ツール「Aipoリマインダー｣ Ver 1.0.9.1
【 登 録 名 】　AipoReminder1091.zip
【 圧縮形式 】　zip
【 作 成 者 】　Copyright (C) 2009-2010 k.kobayashi
【 HomePage 】　なし
【  e-mail  】　tous.les.deux256@gmail.com
【 動作環境 】　日本語版 Windows XP SP3 32bit/ 日本語版 Vista SP2 64bit
                日本語版 Windows 7 64bit
                .NET Framework 2.0以上
【 掲載月日 】　2010/03/16
【 種    別 】　フリーソフトウェア
===========================================================================

---------------------------------------------------------------------------
--  はじめに  -------------------------------------------------------------
---------------------------------------------------------------------------
　Aipo支援ツール「Aipoリマインダー｣をダウンロードいただきありがとうございます。
　このファイルを必ず最後までお読みいただけますようお願いいたします。

---------------------------------------------------------------------------
--  ソフト紹介  -----------------------------------------------------------
---------------------------------------------------------------------------
　｢Aipoリマインダー｣は、Aipoの新着情報の確認を支援するソフトです。

　Aipo(http://aipostyle.com/)は、社内の情報共有効率化やコミュニケーション活性化を支援するグループウェアです。

　Aipoの新着情報をブラウザで確認しなくても、このアプリを常駐させるだけで一定間隔でチェック出来ます。
　新着情報があるとタスクトレイのアイコンに吹き出しが表示されるので、スケジュールの確認等が簡単に行えます。
　また、もうすぐ始まるスケジュールの10分前にポップアップでお知らせしてくれます。(5分〜60分の間で任意に設定が可能です。)

---------------------------------------------------------------------------
--  使用条件・配布条件・改変条件  -----------------------------------------
---------------------------------------------------------------------------
　本ソフトウエアは個人、商用に限らず使用、配布は自由です。
　ただし、複製、頒布する場合は、当方への報告を義務づけるものとします。
　また、本ソフトウェアの一部または全部を改変あるいは除去することは、いかなる理由においても禁止します。

　本ソフトウェアの使用にあたって、Aipoの開発元である株式会社エイムラック(http://aipostyle.com/)に質問することを禁止します。

　また、本ソフトウェアに使用されているアイコンについては、株式会社エイムラック様にご了承を得て
　使用していますので、アイコンの複製、頒布については禁止します。

---------------------------------------------------------------------------
--  保証・免責  -----------------------------------------------------------
---------------------------------------------------------------------------
　当該ソフトウエアの品質は一切保証いたしませんので使用者の責任においてご利用ください。
　また、本ソフトウエアを使用して発生したいかなる問題について当方は一切の責任を負いません。
　また、Aipoの設定変更(PostgreSQLの設定変更)については、使用者の責任において実施して下さい。
　設定変更にて発生したいかなる問題についても当方は一切の責任を負いません。
　また、Aipoの設定を変更することで、Aipoのバージョンアップやサポートが受けられなくなる可能性がありますので、
　バージョンアップやサポートが必要な場合は、本ソフトウェエアの使用を中止して下さい。
　Aipoの設定変更によりセキュリティレベルが下がる事が懸念されますので、使用者のポリシーにそぐわない場合は、本ソフトウェアの使用を中止して下さい。
　本ソフトウエアの著作権、知的財産権はすべて当方が保持します。

---------------------------------------------------------------------------
--  インストール方法  -----------------------------------------------------
---------------------------------------------------------------------------
　AipoReminder1091.zipを任意のディレクトリに解凍してください。
　解凍後のフォルダ名をAipoReminder1091からAipoReminderに変更しておくと後々のアップデート時にスムーズにアップデートが出来ます。

---------------------------------------------------------------------------
--  アップデート方法  -----------------------------------------------------
---------------------------------------------------------------------------
　以前のバージョンをインストールしたディレクトリに最新のファイルを上書きして下さい。
　別のディレクトリで実行すると以前のバージョンの設定が引き継げません。

---------------------------------------------------------------------------
--  アンインストール方法  -------------------------------------------------
---------------------------------------------------------------------------
　１．解凍先のフォルダを全て削除します。
　２．アプリケーションデータディレクトリのAipoReminderフォルダを削除します。
　　　【XPの場合】
　　　C:\Documents and Settings\ユーザ名\Local Settings\Application Data\AipoReminder
　　　【Vista、Windows 7の場合】
　　　C:\Users\ユーザ名\AppData\Local\AipoReminder
　３．「Windows起動時にAipoリマインダーを起動する」にチェックをしている場合は、スタートアップの中のショートカットを削除します。
　
　※レジストリは一切使用していません。

---------------------------------------------------------------------------
--  制限  -----------------------------------------------------------------
---------------------------------------------------------------------------
　１．動作環境として、.NET Framework2.0以上が必要になります。
　２．Aipo4.0.4.0以上または5.0.0.0以上が同じネットワーク上にインストールされている必要があります。
　　　一部の機能は5.0.0.0以上で使用可能です。

　以下、Aipoの管理者向けの情報です。
　次の情報を元にPostgreSQLの設定を変更することで、本ソフトウェアが正常に動作するようになりますが、セキュリティレベルが下がります。
　使用者のセキュリティポリシーにそぐわない場合は、使用を中止して下さい。

  ３．ポートの設定について
　　　Aipoをインストールしたままの状態ではローカルホストのみのアクセスを許可しているため、AipoリマインダーをクライアントPCにインストールしても
      Aipoに接続出来ないというエラーが表示されますので、PostgreSQLが使用するポートを開ける必要があります。

　　　【Windows XP / Windows Server 2003にAipoをインストールしている場合】
　　　ファイアウォールが有効になっている場合、「例外タブ」で「ポートの追加」より、5432ポートを開けるように設定して頂けないでしょうか。
　　　名前は特に何でも構いませんが、分かり易いように、Aipo_PostgreSQLとし、ポートは5432でTCPを選択して下さい。

　　　セキュリティ対策ソフトでファイアウォールを構築している場合は、そちらの設定が優先されますので、セキュリティ対策ソフトの設定を行って下さい。

　　　【LinuxにAipoをインストールしている場合】
　　　vi /etc/sysconfig/iptables

　　　COMMITの前に、
　　　-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 5432 -j ACCEPT
　　　を追加し、iptables を再起動して下さい。
　　　(RH-Firewall-1-INPUTはディストリビューションによって異なる可能性があります。)

  ４．PostgreSQLの設定変更について(Windowsの場合)
      ここから先はPostgreSQLの知識がある方が行って下さい。

      AipoがEドライブにインストールされている場合は以下のように設定します。
      IPアドレスなどは環境に合わせて変更して下さい。

      【postgresql.confの修正】
      E:\aipo\dpl003\postgresql\data\postgresql.conf

      49行目
      #listen_addresses = 'localhost'
      ↓
      listen_addresses = '*'

      【pg_hba.confの修正】
      E:\aipo\dpl003\postgresql\data\pg_hba.conf
      以下の設定を追加(192.168.24.0/24のネットワークの場合)

      host    all         aipo_reminder         192.168.24.0/24       md5

      【ロールの追加と権限の付与】
      AipoがインストールされているPostgreSQLに対して以下のコマンドを実行して下さい。
      (aipo_reminderの名前やパスワード(reminder)については、変更して頂いて構いませんが、
　　　その場合は、Aipoリマインダーの「DB設定」のユーザIDやパスワードも合わせて修正して下さい。)

      以下のコマンドを一気に実行するバッチを用意しています。
　　　postgres_setting.batを実行するとコマンドを入力する手間が省けます。
　　　【使い方】
　　　バッチファイルをテキストエディタで開き、7行目のpsql実行ファイルのパスを環境に合わせて設定し、Aipoがインストールされている環境にて実行して下さい。

　　　一つ一つ実行する場合は以下の手順で行って下さい。
      Windowsのコマンドプロンプトから実行する場合は、E:\aipo\dpl003\postgresql\bin に移動したあと、以下のコマンドを実行して下さい。

      psql -d org001 -U aipo_postgres

      PostgreSQLに接続出来たら、以下のコマンドを順に実行して下さい。

      CREATE ROLE aipo_reminder WITH LOGIN PASSWORD 'reminder';
      GRANT SELECT ON eip_t_schedule_map TO aipo_reminder;
      GRANT SELECT ON eip_t_schedule TO aipo_reminder;
      GRANT SELECT ON turbine_user TO aipo_reminder;
      GRANT SELECT ON turbine_group TO aipo_reminder;
      GRANT SELECT ON turbine_user_group_role TO aipo_reminder;
      GRANT SELECT ON eip_t_whatsnew TO aipo_reminder;
      GRANT SELECT ON eip_t_blog_entry TO aipo_reminder;
      GRANT SELECT ON eip_t_blog_comment TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_request_map TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_request TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_category TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_topic TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_category TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_category_map TO aipo_reminder;
      GRANT SELECT ON eip_t_note TO aipo_reminder;
      GRANT SELECT, INSERT, UPDATE ON eip_t_ext_timecard TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system_map TO aipo_reminder;
      GRANT UPDATE ON eip_t_ext_timecard_timecard_id_seq TO aipo_reminder;

      \q で切断します。

      最後にAipoの再起動を行って下さい。

  ５．PostgreSQLの設定変更について(Linuxの場合)
      ここから先はPostgreSQLの知識がある方が行って下さい。

      Aipoが /usr/local/aipo にインストールされている場合は以下のように設定します。
      IPアドレスなどは環境に合わせて変更して下さい。

      【postgresql.confの修正】
      vi /usr/local/aipo/postgres/data/postgresql.conf

      49行目
      #listen_addresses = 'localhost'
      ↓
      listen_addresses = '*'

      【pg_hba.confの修正】
      vi /usr/local/aipo/postgres/data/pg_hba.conf
      以下の設定を追加(192.168.24.0/24のネットワークの場合)

      host    all         aipo_reminder         192.168.24.0/24       md5

      【ロールの追加と権限の付与】
      AipoがインストールされているPostgreSQLに対して以下のコマンドを実行して下さい。
      (aipo_reminderの名前やパスワード(reminder)については、変更して頂いて構いませんが、
　　　その場合は、Aipoリマインダーの「DB設定」のユーザIDやパスワードも合わせて修正して下さい。)

      Aipoが起動されていない場合は以下のコマンドで起動させて下さい。
      /usr/local/aipo/bin/startup.sh

      以下のコマンドでaipo_postgresユーザになります。
      su - aipo_postgres

      PostgreSQLに接続します。
      psql -d org001 -U aipo_postgres

      PostgreSQLに接続出来たら、以下のコマンドを順に実行して下さい。

      CREATE ROLE aipo_reminder WITH LOGIN PASSWORD 'reminder';
      GRANT SELECT ON eip_t_schedule_map TO aipo_reminder;
      GRANT SELECT ON eip_t_schedule TO aipo_reminder;
      GRANT SELECT ON turbine_user TO aipo_reminder;
      GRANT SELECT ON turbine_group TO aipo_reminder;
      GRANT SELECT ON turbine_user_group_role TO aipo_reminder;
      GRANT SELECT ON eip_t_whatsnew TO aipo_reminder;
      GRANT SELECT ON eip_t_blog_entry TO aipo_reminder;
      GRANT SELECT ON eip_t_blog_comment TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_request_map TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_request TO aipo_reminder;
      GRANT SELECT ON eip_t_workflow_category TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_topic TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_category TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_category_map TO aipo_reminder;
      GRANT SELECT ON eip_t_note TO aipo_reminder;
      GRANT SELECT, INSERT, UPDATE ON eip_t_ext_timecard TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system_map TO aipo_reminder;
      GRANT UPDATE ON eip_t_ext_timecard_timecard_id_seq TO aipo_reminder;

      \q で切断します。

      最後にAipoの再起動を行って下さい。

---------------------------------------------------------------------------
--  注意  -----------------------------------------------------------------
---------------------------------------------------------------------------
　１．全ての環境で動作するとは限りません。 

---------------------------------------------------------------------------
--  使い方  ---------------------------------------------------------------
---------------------------------------------------------------------------
　１．解凍したフォルダにある「AipoReminder.exe」を起動します。
　２．初期状態でデスクトップに表示されるウィンドウに、
　　　・ログイン名
　　　・パスワード
　　　・URL(Aipoのログイン画面のURL http://192.168.24.52:81/aipo/ など)
　　　を入力し、「保存」ボタンを押してください。
　３．「スケジュール確認」は、もうすぐ始まるスケジュールの確認時間です。
　　　指定したXX分前にポップアップでもうすぐ始まるスケジュールを表示します。
　４．DB設定については、Aipoのインストール時の設定を初期設定として設定していますので、特に変更の必要はありません。
　　　(変更されている場合は、Aipoの管理者に確認して下さい。)
　５．新着情報については、Windowsの時計の5分毎にチェックしています。
　６．本ソフトウェアを終了する場合は、タスクトレイのアイコンを右クリックして、「終了」を選んで下さい。

---------------------------------------------------------------------------
--  よくある質問  ---------------------------------------------------------
---------------------------------------------------------------------------
　１．「Aipoに接続できませんでした。」と表示される。

　　　【回答】
　　　　この場合、エラーログファイルを確認して下さい。AipoReminder.yyyy-MM-dd.log
　　　　という形式でカレントディレクトリに作成されます。
　　　　エラーログに、「'192.168.xxx.xxx' へ接続の確立に失敗しました。」と表示されている場合、
　　　　Aipo側のPostgreSQLの設定が正しく変更されていない可能性と、
　　　　Aipoがインストールされているサーバのファイアウォールで接続が遮断されている可能性があります。

　　　　PostgreSQLの設定については、制限の「４．PostgreSQLの設定変更について(Windowsの場合)」もしくは、
　　　　「５．PostgreSQLの設定変更について(Linuxの場合)」を再度確認して下さい。

　　　　ファイアウォールの場合は、制限の「３．ポートの設定について」を再度確認して下さい。

---------------------------------------------------------------------------
--  最後に  ---------------------------------------------------------------
---------------------------------------------------------------------------
　｢Aipoリマインダー｣に関する要望、不具合報告を随時受け付けております。
　k.kobayashiまでメールでご連絡下さい。
　不具合報告の際は、出来れば動作させているマシンの詳細な環境情報を添えて下さい。

---------------------------------------------------------------------------
--  既知のバグ  -----------------------------------------------------------
---------------------------------------------------------------------------

---------------------------------------------------------------------------
--  改版履歴  -------------------------------------------------------------
---------------------------------------------------------------------------
■ Ver 1.0.9.1 (2010/03/16)
　【バグ】
　・Ver 1.0.9.0で追加したタイムカード連携で、ユーザの勤務形態が通常の場合
　　エラーが発生していたバグを修正

■ Ver 1.0.9.0 (2010/03/06)
　【機能追加】
　・リマインダーとタイムカードの連携機能を追加した(Aipoのバージョン5以降で使用可)
    1.リマインダー起動時に、その日のタイムカード「出勤」に登録がなければリマインダー起動時刻を自動登録
　　2.リマインダー終了時に、その日のタイムカード「退勤」に登録がなければリマインダー終了時刻を自動登録

    初めて設定する場合など
    1.アカウント設定済みで「タイムカードと連携する」にチェックを入れてお知らせ設定を保存したとき、
　　　その日のタイムカード「出勤」に登録がなければ現在時刻を自動登録
　　2.アカウント設定前に、「タイムカードと連携する」にチェックを入れてお知らせ設定を保存した後にアカウント設定したとき、
　　　その日のタイムカード「出勤」に登録がなければ現在時刻を自動登録

　　このバージョン以降で、この機能を使用する場合は、以下のコマンドを実行して、aipo_reminderに対して権限を付与しなければエラーが発生する(エラーログが作られる)。
　　(前述の「制限 - ４．PostgreSQLの設定変更について」を参照)

      GRANT SELECT, INSERT, UPDATE ON eip_t_ext_timecard TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system TO aipo_reminder;
      GRANT SELECT ON eip_t_ext_timecard_system_map TO aipo_reminder;
      GRANT UPDATE ON eip_t_ext_timecard_timecard_id_seq TO aipo_reminder;

■ Ver 1.0.8.1 (2010/02/22)
　【変更】
　・ソースを見直し、.NET Frameworkのバージョンを3.5から2.0に変更。
　　不要なDLLの読み込みがなくなったため、若干のパフォーマンスアップが期待できる。と思う…

■ Ver 1.0.8.0 (2010/02/06)
　【変更】
　・Npgsqlのバージョンを2.0.8にアップデートした
　・スケジュールの新着情報の日付をスケジュールの開始日に変更した
　・設定を保存するときのメッセージボックスを止めて、ステータスバーに表示するようにした
　・お知らせ設定の設定後に、新着情報をチェックするようにした

　【機能追加】
　・起動時にその日の終日スケジュールがあれば、お知らせ情報を表示するようにした
　・新着情報の吹き出しをウィンドウタイプに変更出来るようにした

■ Ver 1.0.7.0 (2010/01/11)
　【バグ】
　・Ver 1.0.6.0で直っていなかった以下のバグを修正した
　　・「トピックの閲覧／返信」 が「所属メンバーのみ閲覧／返信可」の場合、
　　　所属メンバーの中で1人でもブラウザにて新着確認していないメンバーがいる(メンバー全員が確認を終えていない)状態のとき、
　　　所属している、していないに関係なく新着情報が表示されていた

　【変更】
　・Npgsqlのバージョンを2.0.7にアップデートした

　【機能追加】
　・起動時にAipoに接続できなかった場合、何度かリトライした後、ログイン出来ない場合に接続失敗のメッセージを表示するようにした
　・他のユーザのスケジュールもチェック出来るようにした(公開区分が "公開" となっているもののみ)

　　このバージョン以降、以下のコマンドを実行して、aipo_reminderに対して権限を付与しなければエラーが発生する(エラーログが作られる)。
　　(前述の「制限 - ４．PostgreSQLの設定変更について」を参照)

      GRANT SELECT ON turbine_group TO aipo_reminder;
      GRANT SELECT ON turbine_user_group_role TO aipo_reminder;

　【その他】
　・Windows用にaipo_reminderの権限を付与するバッチ(postgres_setting.bat)を作成した
　　【使い方】
　　バッチファイルをテキストエディタで開き、7行目のpsql実行ファイルのパスを環境に合わせて設定し、Aipoがインストールされている環境にて実行する

■ Ver 1.0.6.0 (2009/12/06)
　【バグ】
　・以下のバグを修正した
　　・掲示板を作成したあとにトピックの閲覧権限(カテゴリの変更)を変更した場合に正しく閲覧制限されない
　　・掲示板の「所属メンバーのみ閲覧／返信可」カテゴリを指定した場合、新着情報が何度も表示される場合がある
　　
　　このバージョン以降、以下のコマンドを実行して、aipo_reminderに対して権限を付与しなければエラーが発生する(エラーログが作られる)。
　　(前述の「制限 - ４．PostgreSQLの設定変更について」を参照)

      GRANT SELECT ON eip_t_msgboard_category TO aipo_reminder;
      GRANT SELECT ON eip_t_msgboard_category_map TO aipo_reminder;

■ Ver 1.0.5.0 (2009/12/03)
　【変更】
　・Aipo5に対応した
　　PostgreSQLの設定はAipoのバージョン4と同じ方法でいいことを確認(但し、設定後にAipoの再起動が必要)
　　メイン画面でバージョン4、5を指定出来るようにした

　【その他】
　・日本語版 Windows 7 64bitで正常に動作することを確認した

■ Ver 1.0.4.0 (2009/10/18)
　【バグ】
　・掲示板の新着情報を確認後も新着メッセージが表示されてしまっていたバグを修正した

　【変更】
　・バージョン表記を修正
　・Npgsqlのバージョンを2.0.6にアップデートした

　【その他】
　・Vistaに対応
　・ReadMe.txtにVistaに関する説明を追加(動作環境、アンインストール方法)
　・Aipo4の Ver 4.0.4.0 ⇒ Ver 4.0.5.0へのアップデートで正常動作を確認した
　　(PostgreSQLへの設定変更はそのまま維持されています)

■ Ver 1.0.3 (2009/06/19)
　【バグ】
　・メイン画面の文言を修正した

　【変更】
　・エラーログのファイル名を MyApp.yyyy-MM-dd.log から AipoReminder.yyyy-MM-dd.log に変更した

　【その他】
　・ReadMe.txtのバージョン表記等を修正した
　・ReadMe.txtによくある質問とその回答を記述した
　・ReadMe.txtにポートの設定方法を追記した

■ Ver 1.0.2 (2009/06/18)
　【バグ】
　・他人のスケジュールもバルーンに表示されていた可能性があったのを修正した
　・非公開、完全に隠すスケジュールのお知らせがバルーンに表示されていなかったバグを修正した

　【機能追加】
　・繰り返しスケジュールに対応した

　【変更】
　・タスクトレイのアイコンをダブルクリックしたときにブラウザを開くようにした
　・もうすぐ始まる予定に参加者を表示しないようにした

　【その他】
　・ReadMe.txtにアップデート方法とLinux上のPostgreSQLの設定変更方法を追加した
　・ReadMe.txtのインストール方法を修正した

■ Ver 1.0.1 (2009/05/17)
　【バグ】
　・ありえないバグを修正した(必ず入力チェックエラーとなる)

　【変更】
　・Npgsqlのバージョンを2.0.5にアップデートした

■ Ver 1.0.0 (2009/04/20)
　・初版

---------------------------------------------------------------------------
